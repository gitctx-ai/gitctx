# TASK-0001.1.2.7: Fix get_source() Complexity Violation

**Parent Story**: [STORY-0001.1.2](README.md)
**Status**: ✅ Complete
**Estimated Hours**: 0.25
**Actual Hours**: 0.25

## Objective

Extract helper method from `GitCtxSettings.get_source()` to reduce cyclomatic complexity from 11 to ≤10, passing ruff complexity checks.

## Context

The config module (460 lines, 19 functions) is clean and well-organized. Only issue: `get_source()` method has cyclomatic complexity of 11 (threshold is 10). This needs a focused fix, not architectural refactoring.

**Current violation:**
```
src/gitctx/core/config.py:XXX:X: C901 `get_source` is too complex (11 > 10)
```

## Implementation Checklist

- [x] Identify the specific conditional logic causing complexity >10
- [x] Extract one helper method to reduce complexity
- [x] Ensure behavior unchanged (same source detection logic)
- [x] Run quality gates: `uv run poe fix && uv run poe quality`
- [x] Verify cyclomatic complexity ≤10

## Acceptance Criteria

- `ruff check` passes with no C901 violations
- `get_source()` cyclomatic complexity ≤10
- Source detection behavior unchanged (all tests pass)
- No other code changes needed (focused fix only)

## Files to Modify

- [src/gitctx/core/config.py](../../../../../src/gitctx/core/config.py) - Extract helper from `get_source()`

## Technical Notes

**Approach** (extract conditional logic):

Current structure likely has multiple `if/elif` chains for source detection:
```python
def get_source(self, key: str) -> str:
    if key.startswith("api_keys."):
        if env_var_set:
            return "OPENAI_API_KEY"
        elif user_file_exists:
            return "user config"
        # ... more conditions
    else:
        if gitctx_env_set:
            return f"GITCTX_{key.upper()}"
        elif repo_file_exists:
            return "repo config"
        # ... more conditions
```

**Fix**: Extract helper method:
```python
def _get_api_key_source(self, key: str) -> str:
    """Determine source for API key configuration."""
    if env_var_set:
        return "OPENAI_API_KEY"
    elif user_file_exists:
        return "user config"
    # ... (reduces complexity by splitting logic)

def get_source(self, key: str) -> str:
    if key.startswith("api_keys."):
        return self._get_api_key_source(key)
    else:
        return self._get_repo_setting_source(key)
```

This reduces `get_source()` complexity while maintaining identical behavior.

## Test Strategy

**Verification**:
- All existing unit tests pass (no behavior change)
- `uv run ruff check src/gitctx/core/config.py` shows no C901 violations
- No new tests needed (internal refactor only)

## Definition of Done

- [ ] Cyclomatic complexity ≤10 for `get_source()`
- [ ] All existing tests pass
- [ ] All quality gates pass
- [ ] Task marked complete in story README
