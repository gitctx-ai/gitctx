# TASK-0001.4.2.1: Write BDD Scenarios for HEAD Boosting

**Parent Story**: [STORY-0001.4.2](README.md)
**Status**: ðŸ”µ Not Started
**Estimated Hours**: 2
**Actual Hours**: -

## Objective

Write ALL 3 BDD scenarios for HEAD boosting (HEAD ranks higher, boost doesn't override relevance, boost breaks ties) with stubbed step definitions. All scenarios should fail with NotImplementedError (expected).

## BDD Progress

**Before this task**: 0/3 scenarios exist
**After this task**: 0/3 scenarios passing (all stubbed, all failing ðŸ”´)

**Scenarios for this task:**
- Scenario 1: HEAD code ranks higher than historical code
- Scenario 2: Boost applies to hybrid scores, not absolute ranking
- Scenario 3: Equal semantic matches prefer HEAD code

## Implementation Checklist

### Phase 1: Create Feature File

- [ ] Create `tests/e2e/features/head_boosting.feature`
- [ ] Write Scenario 1: "HEAD code ranks higher than historical code"
  - [ ] Given repository with current.py (HEAD) and old.py (historical)
  - [ ] When search for "auth"
  - [ ] Then current.py ranks above old.py
  - [ ] And HEAD results have 1.5x boost applied
- [ ] Write Scenario 2: "Boost applies to hybrid scores, not absolute ranking"
  - [ ] Given repository with files at different scores (HEAD lower score, historical higher)
  - [ ] When search for "authentication system"
  - [ ] Then historical ranks first (0.95 > 0.6 * 1.5 = 0.9)
  - [ ] And boost does not override semantic relevance
- [ ] Write Scenario 3: "Equal semantic matches prefer HEAD code"
  - [ ] Given repository with identical content (HEAD and historical, same score)
  - [ ] When search for "AuthMiddleware"
  - [ ] Then HEAD ranks first (0.8 * 1.5 = 1.2 > 0.8)
  - [ ] And HEAD boost breaks ties

### Phase 2: Create Stubbed Step Definitions

- [ ] Create `tests/e2e/steps/head_boosting_steps.py`
- [ ] Stub step: "Given a repository with files at different commits" (table with is_head column)
- [ ] Stub step: "When I search for {query}"
- [ ] Stub step: "Then {file} should rank above {other_file}"
- [ ] Stub step: "And HEAD results should have 1.5x boost applied"
- [ ] Stub step: "And boost does not override semantic relevance"
- [ ] Stub step: "And HEAD boost breaks ties"
- [ ] All stubs raise NotImplementedError with task reference

### Verification

- [ ] Run `uv run pytest tests/e2e/features/head_boosting.feature -v`
- [ ] Verify all 3 scenarios fail with NotImplementedError
- [ ] Commit: `test(TASK-0001.4.2.1): Write BDD scenarios for HEAD boosting (0/3 stubbed)`

## Files to Create

- **CREATE**: `tests/e2e/features/head_boosting.feature` (~70 lines, 3 Gherkin scenarios)
- **CREATE**: `tests/e2e/steps/head_boosting_steps.py` (~100 lines, 6 stubbed steps)

## Pattern Reuse

- **e2e_indexed_repo_factory** - Create repos with is_head metadata for testing
- **Existing search_steps.py** - Pattern for step definition structure

## Dependencies

**None** - TASK-1 in incremental BDD pattern
